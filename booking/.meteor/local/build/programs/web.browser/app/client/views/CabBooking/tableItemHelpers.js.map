{"version":3,"sources":["meteor://ðŸ’»app/client/views/CabBooking/tableItemHelpers.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E","file":"/client/views/CabBooking/tableItemHelpers.js","sourcesContent":["jquerycache = {};//cache the jquery calls because they're slow. do em once per route, clearing on every new route.\nfillJqueryCache = function() {\n\tSession.get(\"date\");\n\tSession.get('selectedProviderName');\n\t//console.log('filling the jquery cache');\n\tjquerycache.theadth = $(\"thead th\").css(\"height\");//table header height\n\tjquerycache.rowHeight = $(\".timeRow\")[1].clientHeight;//the first row is different height between browsers.\n\tjquerycache.headerWidth = parseInt($(\".rowHeader\").css(\"width\"));\n\tjquerycache.tableItemHeight = parseInt($('.tableItemData').css('height'));\n\t\n\n};\n\nbuildTableItemStyle = function(thisobj) {//centralizing this function improves DRY and\n\t//allows us to avoid doing any of this expensive stuff until the times table is rendered\n\tif (!Session.get('timesRendered')) {\n\t\treturn 0;\n\t}\n\tvar height = tableItemHeight(thisobj);\n\treturn \"style=\\\"\" +\n\t\t\"width:auto;max-height:\" +height+\n\t\t\";height:\" + height +\n\t\t\";left:\" + tableItemLeft(thisobj) +\n\t\t\";top:\" + tableItemTop(thisobj) +\n\t\t\";\\\"\"\n};\n\nhighlightItemHelper = function(thisobj) {\n\tif(typeof Session.get('currentlyEditingDoc') !== \"undefined\"\n\t\t&& Session.get(\"currentlyEditingDoc\") === thisobj._id) {\n\n\t\treturn \"being-edited\";\n\t}\n};\n\ninBetween = function(thisobj) {\n\tif (!Session.get('timesRendered')) {\n\t\treturn 0;\n\t}\n\tvar provObj = getProvObject(Session.get(\"date\"), Session.get('selectedProviderName'));\n\tif (((jquerycache.rowHeight/provObj.appointmentLength)*thisobj.length) >= (jquerycache.tableItemHeight * 4)) {\n\t\treturn '<br/>'\n\t}\n\telse {\n\t\treturn \" - \"\n\t}\n};\n\ntableItemHeight = function(thisobj) {\n\t\tif (thisobj.length == Session.get(\"appntlength\"))\n\t\t{\n\t\t\treturn jquerycache.rowHeight +\"px\";\n\t\t}\n\t\tvar provObject = getProvObject(Session.get(\"date\"), Session.get('selectedProviderName'));\n\t\tvar defaultHeight = jquerycache.rowHeight;\n\t\tvar pxPerMinute = defaultHeight/provObject.appointmentLength;\n\t\treturn Math.ceil(pxPerMinute * thisobj.length) + \"px\";\n};\ntableItemLeft = function(thisobj) {\n\treturn jquerycache.headerWidth + \"px\";\n};\ntableItemTop = function(thisobj) {\n\tif (!thisobj.date) {//this is a blockout\n\t\tvar datestring = moment(Session.get(\"date\")).tz(\"Pacific/Auckland\").format(\"YYYY-MM-DD \") + thisobj.time;\n\t\tvar thedate = moment(datestring, \"YYYY-MM-DD hh:mm A\").toDate();\n\t\t// console.log(thedate);\n\t} else {\n\t\tthedate = thisobj.date\n\t}\n\tvar provObject = getProvObject(Session.get(\"date\"), Session.get('selectedProviderName'));\n\n\tvar startTime = Session.get(\"date\");\n\tstartTime.setHours(provObject.startTime);\n\t//numFromTop is the number of minutes from the beginning of the day this item is\n\tvar numFromTop = (thedate.getTime() -\n\t\t\t\t  startTime.getTime())/1000/60;\n\n\n\tif(numFromTop/provObject.appointmentLength === 0){//special case for first item of the day.\n\t\treturn jquerycache.theadth;\n\t}\n\telse\n\t{\n\t\tvar untouchedAppntsFromTop = (numFromTop/provObject.appointmentLength)+1;\n\n\t\tvar appntsFromTop = Math.floor(untouchedAppntsFromTop);\n\t\tvar pixelsFromTop = jquerycache.rowHeight*appntsFromTop;\n\n\t\tif (untouchedAppntsFromTop % 1 !== 0){\n//\t\t\t//if the appnt doesn't align with standard boundries - i.e, 15 mins\n\t\t\tpixelsFromTop += jquerycache.rowHeight *\n\t\t\t(untouchedAppntsFromTop % 1);\n\t\t}\n\t\t//console.log(\"Editing: \"+Session.get(\"currentlyEditingDoc\"))\n\t\tif(Session.equals(\"currentlyEditingDoc\", thisobj._id) && thisobj._id)/*if _id is null we are a blockout*/ {\n\n\t\t\tSession.set(\"scrollToPoint\", pixelsFromTop);\n\t\t} else if (Session.equals(\"changedAppointmentID\", thisobj._id)\n\t\t\t\t&& typeof Session.get(\"changedAppointmentID\") !== \"undefined\") {\n\t\t\tSession.set(\"scrollToPoint\", pixelsFromTop);\n\t\t\tSession.set(\"changedAppointmentID\", null);\n\t\t}\n\t\treturn pixelsFromTop + \"px\";\n\t}\n};"]}